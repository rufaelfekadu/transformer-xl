
starting
/home/amirbek/project/transformer-xl/pytorch/mem_transformer_operator.py:364: UserWarning: masked_fill_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (Triggered internally at ../aten/src/ATen/native/cuda/Indexing.cu:1440.)
  attn_score = attn_score.float().masked_fill(
/home/amirbek/.conda/envs/project/lib/python3.8/site-packages/torchgpipe/stream.py:99: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  tensor = tensor.new_empty([0]).set_(tensor.storage())
/home/amirbek/.local/lib/python3.8/site-packages/torch/autograd/__init__.py:200: UserWarning: masked_fill_ received a mask with dtype torch.uint8, this behavior is now deprecated,please use a mask with dtype torch.bool instead. (Triggered internally at ../aten/src/ATen/native/cuda/Indexing.cu:1440.)
  Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
/home/amirbek/.local/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:152: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
| epoch   1 step      200 |    200 batches | lr 0.00025 | ms/batch 240.40 | loss  2.78 | bpc   4.00747
| epoch   1 step      400 |    400 batches | lr 0.00025 | ms/batch 223.83 | loss  2.13 | bpc   3.07603
| epoch   1 step      600 |    600 batches | lr 0.00025 | ms/batch 224.19 | loss  1.97 | bpc   2.84566
| epoch   1 step      800 |    800 batches | lr 0.00025 | ms/batch 224.01 | loss  1.77 | bpc   2.54675
| epoch   1 step     1000 |   1000 batches | lr 0.00025 | ms/batch 223.78 | loss  1.72 | bpc   2.47467
| epoch   1 step     1200 |   1200 batches | lr 0.00025 | ms/batch 224.64 | loss  1.60 | bpc   2.31287
| epoch   1 step     1400 |   1400 batches | lr 0.00025 | ms/batch 225.80 | loss  1.58 | bpc   2.27974
| epoch   1 step     1600 |   1600 batches | lr 0.00025 | ms/batch 225.25 | loss  1.63 | bpc   2.35172
| epoch   1 step     1800 |   1800 batches | lr 0.00025 | ms/batch 224.73 | loss  1.55 | bpc   2.23326
| epoch   1 step     2000 |   2000 batches | lr 0.00025 | ms/batch 224.62 | loss  1.58 | bpc   2.27851
| epoch   1 step     2200 |   2200 batches | lr 0.00025 | ms/batch 224.32 | loss  1.50 | bpc   2.16891
| epoch   1 step     2400 |   2400 batches | lr 0.00025 | ms/batch 223.44 | loss  1.51 | bpc   2.17919
| epoch   1 step     2600 |   2600 batches | lr 0.00025 | ms/batch 224.28 | loss  1.45 | bpc   2.09727
| epoch   1 step     2800 |   2800 batches | lr 0.00025 | ms/batch 224.73 | loss  1.45 | bpc   2.08858
| epoch   1 step     3000 |   3000 batches | lr 0.00025 | ms/batch 224.03 | loss  1.37 | bpc   1.97747
| epoch   1 step     3200 |   3200 batches | lr 0.00025 | ms/batch 223.91 | loss  1.36 | bpc   1.95901
| epoch   1 step     3400 |   3400 batches | lr 0.00025 | ms/batch 224.49 | loss  1.41 | bpc   2.03106
| epoch   1 step     3600 |   3600 batches | lr 0.00025 | ms/batch 226.41 | loss  1.34 | bpc   1.93446
| epoch   1 step     3800 |   3800 batches | lr 0.00025 | ms/batch 225.95 | loss  1.35 | bpc   1.95401
| epoch   1 step     4000 |   4000 batches | lr 0.00025 | ms/batch 225.93 | loss  1.30 | bpc   1.88074
validation start
started eval
finished eval
torch no grad
Traceback (most recent call last):
  File "train.py", line 597, in <module>
    train()
  File "train.py", line 546, in train
    val_loss = evaluate(va_iter)
  File "train.py", line 428, in evaluate
    log_table(data, target, ret)
  File "train.py", line 457, in log_table
    for img, pred, targ, prob in zip(images.to("cpu"), predicted.to("cpu"), labels.to("cpu")):
NameError: name 'images' is not defined